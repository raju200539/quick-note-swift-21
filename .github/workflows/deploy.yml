- uses: appleboy/ssh-action@v1.0.0
  with:
    host: ${{ secrets.EC2_HOST }}
    username: ${{ secrets.EC2_USER }}
    port: ${{ secrets.EC2_PORT }}
    key_path: private_key.pem
    script: |
      if [ ! -d quick-note-swift-21 ]; then
        git clone https://github.com/raju200539/quick-note-swift-21.git
      else
        cd quick-note-swift-21
        git checkout main
        git pull origin main
        cd ..
      fi

      cd quick-note-swift-21
      git log -n 2

      sudo docker stop my-app || true
      sudo docker rm my-app || true
      sudo docker build --no-cache -t my-app .
      sudo docker run -d -p 80:80 --name my-app my-app
